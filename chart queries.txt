--
SELECT film.film_id, COUNT(*) AS rentals
FROM rental
JOIN inventory 
  ON rental.inventory_id = inventory.inventory_id
JOIN film
  ON inventory.film_id = film.film_id
GROUP BY film.film_id
ORDER BY rentals DESC
LIMIT 10;

SELECT customer_id, COUNT(rental_id) AS rentals
FROM rental
GROUP BY customer_id
ORDER BY rentals DESC
LIMIT 10;

SELECT customer.first_name, customer.last_name
FROM customer
JOIN rental ON customer.customer_id = rental.customer_id
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film ON inventory.film_id = film.film_id;

SELECT film.title, SUM(payment.amount) AS total_revenue
FROM film
JOIN inventory ON film.film_id = inventory.film_id
JOIN rental ON inventory.inventory_id = rental.inventory_id
JOIN payment ON rental.rental_id = payment.rental_id
GROUP BY film.title
ORDER BY total_revenue DESC
LIMIT 10;

SELECT film.title, AVG(EXTRACT(DAY FROM RETURN_DATE - RENTAL_DATE)) AS average_duration
FROM film
JOIN inventory ON film.film_id = inventory.film_id
JOIN rental ON inventory.inventory_id = rental.inventory_id
GROUP BY film.title
ORDER BY average_duration DESC
LIMIT 10;

SELECT DATE(rental_date) AS rental_date, COUNT(*) AS rental_count
FROM rental
GROUP BY DATE(rental_date)
ORDER BY rental_count DESC
LIMIT 50;

SELECT customer.first_name, customer.last_name, COUNT(rental.rental_id) AS rental_count, AVG(EXTRACT(DAY FROM RETURN_DATE - RENTAL_DATE)) AS average_rental_duration
FROM customer
JOIN rental ON customer.customer_id = rental.customer_id
GROUP BY customer.first_name, customer.last_name;

SELECT film.title, COUNT(rental.rental_id) AS rental_count
FROM film
JOIN inventory ON film.film_id = inventory.film_id
JOIN rental ON inventory.inventory_id = rental.inventory_id
GROUP BY film.title;

SELECT DATE(rental_date) AS rental_date, COUNT(*) AS rental_count
FROM rental
GROUP BY DATE(rental_date)
ORDER BY rental_date;


Revenue analysis:

SELECT film.title, customer.first_name, customer.last_name, SUM(payment.amount) AS total_revenue, DATE(payment.payment_date) AS payment_date
FROM film
JOIN inventory ON film.film_id = inventory.film_id
JOIN rental ON inventory.inventory_id = rental.inventory_id
JOIN payment ON rental.rental_id = payment.rental_id
JOIN customer ON payment.customer_id = customer.customer_id
GROUP BY film.title, customer.first_name, customer.last_name, payment_date;

Inventory management analysis:

SELECT film.title, inventory.store_id, COUNT(inventory.inventory_id) AS inventory_count
FROM film
JOIN inventory ON film.film_id = inventory.film_id
GROUP BY film.title, inventory.store_id;

Rental trend analysis:
vbnet
Copy code
SELECT DATE(rental_date) AS rental_date, COUNT(*) AS rental_count
FROM rental
GROUP BY DATE(rental_date)
ORDER BY rental_date;
